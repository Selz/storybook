<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Selz components</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" media="screen" href="./style.css" />
        <script>

            // document.addEventListener("DOMContentLoaded", function () {

            //     // var q = {};

            //     // location.href.split('?')[1].split('&').forEach(function (i) {
            //     //     q[i.split('=')[0]] = i.split('=')[1];
            //     // });

            //     // console.log(q);

            //     let frame = document.getElementById('frame');

            //     frame.contentWindow.postMessage("MESSAGE FROM PARENT", '*');
            // });

            // window.addEventListener("message", receiveMessage, false);

            // function receiveMessage(event) {
            //     // if (event.origin !== "http://example.org:8080")
            //     //     return;

            //     console.log('FROM CHILD', event.data);
            // }

            window.addEventListener("message", receiveMessage, false);

            function receiveMessage(event) {

                // if (event.origin !== "http://components.selz.com:3100")
                //     return;

                // const frame = document.querySelector('iframe');

                // console.log('DATAFGJFJHFJHFHJCFGHJJHH', event.data);

                let data;

                data = JSON.parse(event.data.replace("\'", ""));

                if (typeof data === 'object') {

                    if (data.event.type === 'setCurrentStory') {
                        // console.log('DATA', data);
                        // console.log(data.event.args[0].kind);
                        // console.log(data.event.args[0].story);

                        let kind = data.event.args[0].kind;
                        let story = data.event.args[0].story;

                        var pageUrl = `?component=${kind}&story=${story}`;

                        window.history.pushState('', '', pageUrl);
                    }
                }
            }

            // console.log('FRAMES', window.frames)

        </script>
    </head>
    <body>
        <main class="container">
            <div class="nav">
                <div class="logo">
                    <img src="./logo.svg" />
                </div>
            </div>
            <div class="content">
                <iframe id="frame" src="./docs/index.html" />
            </div>
        </div>

    </body>
</html>